/* =================================================================
   Community.css - Final Fixed Version
   ================================================================= */

/* 1. 디자인 토큰 */
:root {
    --primary: #1DAB87;
    --primary-dark: #158F70;
    --primary-light: #E8F8F3;

    --secondary: #FF9900;

    --bg-page: #F5F7FA;
    --bg-card: #FFFFFF;
    --border-color: #E2E8F0;

    --text-main: #2D3748;
    --text-sub: #718096;

    --shadow-card: 0 4px 20px rgba(0, 0, 0, 0.05);
    --radius-card: 16px;
}

/* 유틸리티 클래스 (JS 기능 필수) */
.hidden { display: none !important; }

/* 2. 레이아웃 구조 */
.community-layout {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 32px;
    align-items: flex-start;
    padding-bottom: 60px;
}

.page-header { grid-column: 1 / -1; margin-bottom: 16px; }
.page-header h1 { font-size: 28px; font-weight: 800; color: var(--text-main); margin-bottom: 8px; }
.page-header p { font-size: 16px; color: var(--text-sub); }

/* =================================================================
   3. 새 글 작성 폼
   ================================================================= */
.new-post-form {
    background: var(--bg-card);
    border-radius: var(--radius-card);
    box-shadow: var(--shadow-card);
    padding: 24px;
    margin-bottom: 24px;
    border: none;
}

.new-post-form textarea {
    width: 100%; min-height: 100px;
    border: 1px solid var(--border-color); border-radius: 12px;
    padding: 16px; font-size: 15px; resize: none; outline: none;
    background-color: #FAFAFA; transition: all 0.2s;
}
.new-post-form textarea:focus { border-color: var(--primary); background-color: #fff; }

.post-footer {
    display: flex; justify-content: space-between; align-items: center; margin-top: 16px;
}

.custom-file-button {
    width: 44px; height: 44px; border-radius: 12px;
    background-color: var(--primary-light); color: var(--primary);
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; font-size: 20px; transition: all 0.2s; margin: 0;
}
.custom-file-button:hover { background-color: #D1F2E8; transform: translateY(-2px); }

.post-button {
    background-color: var(--primary); color: white; font-weight: 700;
    border: none; border-radius: 12px; padding: 0 24px; height: 44px;
    font-size: 15px; cursor: pointer; transition: all 0.2s;
    box-shadow: 0 4px 10px rgba(29, 171, 135, 0.2);
}
.post-button:hover { background-color: var(--primary-dark); transform: translateY(-2px); }

/* 새 글 작성 시 이미지 미리보기 영역 */
#image-preview-container {
    margin-top: 16px;
    border-radius: 12px;
    overflow: hidden;
    position: relative;
    background-color: #000;
}

/* =================================================================
   4. 필터 탭
   ================================================================= */
.feed-filters {
    display: flex; gap: 20px; border-bottom: 1px solid var(--border-color); margin-bottom: 24px;
}
.filter-tab {
    background: none; border: none; font-size: 16px; font-weight: 600;
    color: var(--text-sub); padding: 12px 4px; cursor: pointer; position: relative;
}
.filter-tab.active { color: var(--primary); }
.filter-tab.active::after {
    content: ''; position: absolute; bottom: -1px; left: 0; width: 100%;
    height: 3px; background-color: var(--primary); border-radius: 3px 3px 0 0;
}

/* =================================================================
   5. 게시물 카드 (Post Card)
   ================================================================= */
.post-card {
    background: var(--bg-card);
    border-radius: var(--radius-card);
    box-shadow: var(--shadow-card);
    padding: 24px;
    margin-bottom: 24px;
    border: none;
}

/* 헤더 */
.post-header {
    display: flex; align-items: center; gap: 14px; margin-bottom: 16px; position: relative;
}
.post-avatar {
    width: 48px; height: 48px; border-radius: 50%; object-fit: cover; border: 1px solid #eee;
}
.post-author-info {
    flex: 1; display: flex; flex-direction: column; justify-content: center;
}
.author-name { font-size: 16px; font-weight: 700; color: var(--text-main); line-height: 1.2; }
.author-details { font-size: 13px; color: var(--text-sub); margin-top: 2px; }
.author-persona { color: var(--primary); font-weight: 600; }

.post-actions-menu { display: flex; gap: 8px; margin-left: 10px; }
.post-edit-btn, .post-delete-btn {
    background: none; border: none; color: var(--text-sub); font-size: 13px; cursor: pointer;
}
.post-edit-btn:hover, .post-delete-btn:hover { text-decoration: underline; color: var(--text-main); }

.post-health-score {
    background-color: var(--primary-light); color: var(--primary);
    font-size: 13px; font-weight: 700; padding: 6px 12px; border-radius: 20px;
}

/* 본문 */
.post-content-container { margin-bottom: 16px; margin-top: 8px; }
.post-content-text {
    font-size: 15px; color: var(--text-main); line-height: 1.6;
    max-height: 72px; overflow: hidden; text-overflow: ellipsis; /* 더보기 전 기본 */
}
.post-content-text.expanded { max-height: none; overflow: visible; }
.more-button {
    background: none; border: none; color: var(--text-sub);
    font-weight: 600; cursor: pointer; margin-top: 4px;
}

/* ★ [수정 1] 미디어 캐러셀 (완전히 망가진 부분 복구) ★ */
.post-media-carousel {
    position: relative;
    width: 100%;
    /* 높이는 JS나 이미지 비율에 따라 자동 조절되지만 기본값 설정 */
    background-color: #000;
    border-radius: 12px;
    overflow: hidden;
    margin-bottom: 16px;
}

.carousel-inner {
    display: flex; /* 이미지 가로 나열 필수 */
    transition: transform 0.3s ease-in-out;
    width: 100%;
}

.carousel-image {
    min-width: 100%; /* 부모 너비 꽉 채움 */
    width: 100%;
    object-fit: contain; /* 비율 유지 */
    display: block;
    max-height: 600px; /* 너무 길어지지 않게 */
}

/* 캐러셀 화살표 & 점 */
.carousel-control {
    position: absolute; top: 50%; transform: translateY(-50%);
    background: rgba(255, 255, 255, 0.7); border: none;
    width: 32px; height: 32px; border-radius: 50%;
    cursor: pointer; font-size: 18px; display: flex;
    align-items: center; justify-content: center; z-index: 10;
}
.carousel-control.prev { left: 10px; }
.carousel-control.next { right: 10px; }

.carousel-indicator {
    position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%);
    display: flex; gap: 6px; z-index: 10;
}
.dot {
    width: 8px; height: 8px; background: rgba(255,255,255,0.5); border-radius: 50%; cursor: pointer;
}
.dot.active { background: #fff; }


/* 액션 바 (좋아요/댓글) */
.post-actions-bar {
    display: flex; align-items: center; gap: 16px; padding: 12px 0;
    border-top: 1px solid var(--border-color); border-bottom: 1px solid var(--border-color);
    margin-bottom: 16px;
}
.like-button, .comment-button {
    background: none; border: none; display: flex; align-items: center; gap: 6px;
    cursor: pointer; font-size: 15px; color: var(--text-main); font-weight: 500;
}
.like-button i, .comment-button i { font-size: 22px; }
.like-button.active i { color: #FF4757; }
.like-button:active i { transform: scale(1.2); } /* 콩닥 애니메이션 복구 */


/* ★ [수정 2] 게시물 수정 모드 (버튼 줄바꿈 & 이미지 삭제 복구) ★ */
.post-edit-mode {
    display: flex;
    flex-wrap: wrap; /* 내용물 많으면 줄바꿈 허용 */
    align-items: center;
    justify-content: space-between; /* 양 끝 정렬 */
    gap: 10px;
    margin-top: 10px;
}

/* 텍스트 에디터 */
.post-edit-textarea {
    width: 100%; order: 1;
    border: 1px solid var(--border-color); border-radius: 12px;
    padding: 12px; min-height: 100px; resize: vertical; outline: none;
    font-family: inherit; font-size: 15px;
}

/* 수정 중인 이미지 미리보기 컨테이너 */
#edit-preview-container {
    width: 100%; order: 2; margin-bottom: 10px;
}

/* 개별 이미지 삭제 버튼 스타일 (JS 동적 생성) */
.delete-image-btn {
    position: absolute; top: 5px; right: 5px;
    background: rgba(0,0,0,0.6); color: white;
    border: none; border-radius: 50%; width: 24px; height: 24px;
    cursor: pointer; z-index: 20; display: flex;
    align-items: center; justify-content: center; font-size: 14px;
}

/* 카메라 버튼 (왼쪽) */
.post-edit-mode .custom-file-upload {
    order: 3; margin: 0;
}

/* 저장/취소 버튼 (오른쪽) */
.post-edit-mode .edit-actions {
    order: 4; display: flex; gap: 8px;
}
.edit-save-btn {
    background-color: var(--primary); color: white;
    padding: 8px 16px; border-radius: 8px; border: none; font-weight: 700; cursor: pointer;
}
.edit-cancel-btn {
    background-color: #EDF2F7; color: var(--text-main);
    padding: 8px 16px; border-radius: 8px; border: none; font-weight: 600; cursor: pointer;
}


/* 댓글 입력창 (피드 내) */
.post-comments-summary .comment-input-area {
    display: flex; gap: 10px; align-items: center;
}
.comment-input-field {
    flex-grow: 1; background-color: #FAFAFA; border: 1px solid var(--border-color);
    border-radius: 20px; padding: 10px 16px; font-size: 14px; outline: none;
}
.comment-input-field:focus { border-color: var(--primary); background: #fff; }
.comment-submit-btn {
    background: none; border: none; color: var(--primary); font-weight: 700;
    font-size: 15px; cursor: pointer; padding: 0 10px;
}


/* =================================================================
   6. 사이드바 위젯
   ================================================================= */
.feed-sidebar { display: flex; flex-direction: column; gap: 24px; }
.sidebar-widget {
    background: var(--bg-card); border-radius: var(--radius-card);
    box-shadow: var(--shadow-card); padding: 24px; border: none;
}
.sidebar-widget h3 {
    font-size: 18px; font-weight: 700; margin-bottom: 16px; color: var(--text-main);
    border-left: 4px solid var(--primary); padding-left: 10px;
}
.trending-list { list-style: none; padding: 0; margin: 0; }
.trending-list li { margin-bottom: 12px; border-bottom: 1px solid #F0F0F0; padding-bottom: 12px; }
.trending-list li:last-child { border: none; }
.trending-post strong { display: block; font-size: 14px; color: var(--text-main); margin-bottom: 4px; }
.trending-post span { font-size: 13px; color: var(--text-sub); }

.persona-filters { display: flex; flex-wrap: wrap; gap: 8px; }
.persona-tag {
    background-color: var(--bg-page); color: var(--text-sub); border: none;
    border-radius: 20px; padding: 6px 12px; font-size: 13px; font-weight: 600; cursor: pointer;
}
.persona-tag:hover, .persona-tag.active {
    background-color: var(--primary-light); color: var(--primary);
}


/* =================================================================
   7. ★ [수정 3] 모달 (Modal) - 스타일 전면 수정 ★
   ================================================================= */
.modal {
    display: none; /* JS 제어 */
    position: fixed; z-index: 2000; left: 0; top: 0;
    width: 100%; height: 100%;
    background-color: rgba(0, 0, 0, 0.85); /* 배경 더 어둡게 */
    justify-content: center; align-items: center; /* 중앙 정렬 */
}

/* 모달 컨텐츠 박스 (비율 문제 해결) */
.modal-content {
    background-color: #fff;
    width: 90%; max-width: 1100px; /* 넓게 */
    height: 85vh; /* 높게 */
    border-radius: 12px;
    overflow: hidden; /* 둥근 모서리 유지 */
    display: flex; /* 내부 좌우 배치용 */
    position: relative;
    margin: 0; /* 중앙 정렬을 위해 margin 제거 (flex가 해줌) */
}

/* 닫기 버튼 */
.close-button {
    position: absolute; top: 15px; right: 20px;
    color: #fff; font-size: 30px; font-weight: bold;
    cursor: pointer; z-index: 2010; text-shadow: 0 0 5px rgba(0,0,0,0.5);
}

/* 내부 컨테이너 (JS 구조에 맞춤) */
.modal-body-container {
    display: flex; /* 좌우 배치 핵심 */
    width: 100%; height: 100%;
}

/* [왼쪽] 사진 영역 (60%) */
.modal-post-media {
    flex: 0 0 60%;
    width: 60%; height: 100%;
    background-color: #000;
    display: flex; align-items: center; justify-content: center;
    position: relative; overflow: hidden;
}
.modal-post-media .carousel-image {
    max-width: 100%; max-height: 100%;
    object-fit: contain; /* 비율 유지하며 다 보여주기 */
}

/* [오른쪽] 댓글 영역 (40%) */
.modal-comments-area {
    flex: 0 0 40%;
    width: 40%; height: 100%;
    background: #fff;
    display: flex; flex-direction: column;
    z-index: 10;
}

/* 모달 헤더 & 본문 */
.modal-post-header {
    padding: 16px; border-bottom: 1px solid #eee;
    display: flex; align-items: center; gap: 12px;
}
.modal-post-content {
    padding: 16px; border-bottom: 1px solid #eee;
    font-size: 14px; line-height: 1.5; color: var(--text-main);
}

/* 댓글 리스트 (스크롤) */
.modal-comments-list {
    flex: 1; overflow-y: auto; padding: 16px;
    display: flex; flex-direction: column; gap: 16px;
}

/* 댓글 아이템 디자인 */
.comment-item {
    display: flex; gap: 10px; align-items: flex-start; position: relative;
}
.comment-avatar { width: 32px; height: 32px; border-radius: 50%; }
.comment-text-content { flex: 1; font-size: 14px; }
.comment-author { font-weight: 700; margin-right: 6px; font-size: 13px; }
.comment-time { display: block; font-size: 11px; color: #999; margin-top: 4px; }

/* 댓글 수정/삭제 버튼 */
.comment-actions { position: absolute; right: 0; top: 0; }
.comment-edit-btn, .comment-delete-btn {
    font-size: 11px; color: #999; border: none; background: none; cursor: pointer;
}

/* ★ [수정 4] 모달 댓글 입력창 (통일감) ★ */
.modal-comment-input {
    padding: 16px; border-top: 1px solid #eee;
    display: flex; gap: 10px; background: #fff;
}
/* 피드 입력창(.comment-input-field)과 동일한 스타일 적용 */
.modal-comment-input input {
    flex: 1;
    background-color: #FAFAFA;
    border: 1px solid var(--border-color);
    border-radius: 20px; /* 둥글게 */
    padding: 10px 16px;
    font-size: 14px;
    outline: none;
}
.modal-comment-input input:focus {
    border-color: var(--primary); background: #fff;
}
.modal-comment-input button {
    background: none; border: none;
    color: var(--primary); font-weight: 700; cursor: pointer;
}

/* community.css 맨 아래에 추가 */

/* 수정 모드 버튼들을 양옆으로 예쁘게 정렬 */
.edit-actions-container {
    display: flex;
    justify-content: space-between; /* 카메라(좌) <-> 버튼(우) 벌리기 */
    align-items: center;
    width: 100%;
    margin-top: 15px;
}

/* 기존 CSS 충돌 방지: 카메라 버튼 위쪽 여백 제거 */
.post-edit-mode .custom-file-upload {
    margin-top: 0 !important;
}

/* 버튼들 간격 조정 */
.edit-actions {
    display: flex;
    gap: 8px;
}

/* =================================================================
   8. 댓글 수정 모드 스타일 (캡슐 모양)
   ================================================================= */

/* 수정 입력창과 버튼을 감싸는 컨테이너 */
.comment-edit-actions {
    display: flex;       /* 가로 배치 */
    align-items: center; /* 수직 중앙 정렬 */
    width: 100%;         /* 전체 너비 사용 */
    gap: 8px;            /* 입력창과 버튼 사이 간격 */
    margin-top: 6px;
}

.comment-edit-input {
    flex-grow: 1;
    background-color: #FAFAFA;
    border: 1px solid var(--border-color);
    border-radius: 20px;
    padding: 8px 16px;   /* 안쪽 여백 */
    font-size: 14px;
    outline: none;
    transition: all 0.2s;
    font-family: inherit; /* 폰트 상속 */
}

/* 입력창 포커스 시 효과 */
.comment-edit-input:focus {
    border-color: var(--primary);
    background-color: #fff;
}

.comment-save-btn, .comment-cancel-btn {
    border: none;
    background: none;
    font-size: 13px;
    font-weight: 700;
    cursor: pointer;
    padding: 6px 12px;
    border-radius: 12px;
    white-space: nowrap; /* 줄바꿈 방지 */
    transition: background 0.2s;
}

/* 저장 버튼 색상 */
.comment-save-btn {
    color: var(--primary);
}
.comment-save-btn:hover {
    background-color: var(--primary-light);
}

/* 취소 버튼 색상 */
.comment-cancel-btn {
    color: var(--text-sub);
}
.comment-cancel-btn:hover {
    background-color: #EDF2F7;
    color: var(--text-main);
}